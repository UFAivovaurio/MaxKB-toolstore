# 飞书数据源工具

## 简介
飞书数据源工具是一个专为 MaxKB 平台设计的数据源集成工具，用于从飞书云文档（飞书知识库）中获取和下载文档内容。该工具支持多种文档类型，包括飞书文档、表格、文件夹等，可以帮助用户快速将飞书中的知识内容导入到 MaxKB 知识库中。

## 功能特性
- **多文档类型支持**：支持飞书文档（docx）、飞书表格（sheet）、文件夹（folder）等多种类型
- **树形目录展示**：支持以树形结构展示飞书文档目录，可逐层浏览和选择文件
- **批量下载**：支持批量选择并下载多个文件，自动处理文件夹递归下载
- **自动格式转换**：飞书表格自动转换为 Excel 格式（.xlsx）方便处理

## 系统要求

- MaxKB 平台环境
- 飞书开放平台应用（需要创建飞书应用获取 app_id 和 app_secret）
- 飞书应用需要开通以下权限：
  - 查看、评论和下载云文档
  - 查看知识库
  - 获取知识空间文档信息

## 安装依赖

在使用此工具之前，需要先安装所需的依赖包：

```bash
pip install requests
```

依赖包说明：
- `requests` - HTTP 请求库，用于调用飞书开放平台 API

## 配置说明

### 获取飞书应用凭证

1. 访问 [飞书开放平台](https://open.feishu.cn/)，创建企业自建应用
2. 在应用详情页获取 **App ID** 和 **App Secret**
3. 在"权限管理"中开通以下权限：
   - `drive:drive:readonly` - 查看、评论和下载云文档
   - `wiki:wiki:readonly` - 查看知识库
   - `docx:document:readonly` - 获取知识空间文档信息
4. 发布应用版本并在企业内启用

### 工具配置参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| app_id | String | 是 | 飞书应用的 App ID，长度 1-200 字符 |
| app_secret | String | 是 | 飞书应用的 App Secret，长度 1-200 字符 |
| folder_token | String | 是 | 文件夹 token |

## 使用说明

### 在 MaxKB 中使用

1. **添加工具**
   - 在 MaxKB 工具商店中找到"飞书数据源"工具
   - 点击添加并配置 app_id 和 app_secret

2. **配置数据源**
   - 在知识库设置中添加数据源
   - 选择"飞书数据源"工具
   - 在树形选择器中浏览和选择需要导入的文档
   - 支持多选文档和文件夹

3. **同步数据**
   - 确认选择后，工具会自动下载选中的文档
   - 文件夹会自动递归下载其中的所有文档
   - 飞书表格会自动转换为 Excel 格式

## 支持的文件类型

### 飞书原生类型
| 类型 | 说明 | 导出格式 |
|------|------|----------|
| docx | 飞书文档 | .docx |
| sheet | 飞书表格 | .xlsx |
| folder | 文件夹 | 递归处理 |



```